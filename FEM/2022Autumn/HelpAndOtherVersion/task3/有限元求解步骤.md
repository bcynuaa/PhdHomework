

# 有限元求解步骤

## 1. 确定控制方程

比如：
$$
EA\frac{du}{dx}=F
$$

$$
\frac{dy}{dx}=x^3e^x
$$

再比如：
$$
\nabla\cdot\sigma+\vec{f}=0
$$
Euler 方程也是一种控制方程。总体而言，可以写成这样的形式：
$$
Au=f
$$

## 2. 确定求解域 $\Omega$ 和边界 $\partial\Omega$

比如一维问题：求解域是区间，边界是点；

二位问题：求解域是二位面积，边界是曲线。

## 3. 将求解域离散为含节点的小单元

一维：小区间

二维：triangulation mesh, rectangle mesh

## 4. 根据节点值进行单元内部**插值**

interpolation：
$$
u(\vec{x})=\sum_{j=1}^N\phi_j(\vec{x})u_j
$$

## 5. 在每个小单元上对插值型函数 $\phi_j(\vec{x})$ 进行伽辽金法处理

得到局部刚度关系

## 6. 组装总体刚度矩阵

得到：
$$
Ku=b
$$
的形式

## 7. 镶入边界条件

将 $K$ 切片，$b$ 也切片为 $K_m$ 和 $b_m$，再求逆：
$$
u_m=K_m^{-1}b_m
$$

## 8. 得到最终解

最终解是一系列分布在 $\Omega$ 中的离散的点，如果需要得到任意 $\vec{x}$ 位置处的 $u(\vec{x})$ 值，需要先寻找 $\vec{x}$ 所在小单元，再根据这个小单元所拥有的节点值来插值得到。

# problem 3：

## 1. 控制方程

梁：
$$
w'=\theta
$$

$$
F=M'
$$

$$
q=F'
$$

$$
\frac{d^2w}{dx^2}=\frac{1}{\rho}=\frac{M}{EJ}
$$

governing equation:

$$
EJ\frac{d^4w}{dx^4}=q
$$

## 2. 求解域

$0\sim 0.24m$，并且左侧固支，右侧铰支。

## 3. 离散

## 4. 插值

$$
\left(
\begin{array}{cccc}
 \frac{12}{h^3} & \frac{6}{h^2} & -\frac{12}{h^3} & \frac{6}{h^2} \\
 \frac{6}{h^2} & \frac{4}{h} & -\frac{6}{h^2} & \frac{2}{h} \\
 -\frac{12}{h^3} & -\frac{6}{h^2} & \frac{12}{h^3} & -\frac{6}{h^2} \\
 \frac{6}{h^2} & \frac{2}{h} & -\frac{6}{h^2} & \frac{4}{h} \\
\end{array}
\right)
$$

```python
for k in range(N-1):
    if k < (N-1)/2:
        K[2*k:2*k+4, 2*k:2*k+4] += Es * J1 * kpart
        pass
    pass
```

